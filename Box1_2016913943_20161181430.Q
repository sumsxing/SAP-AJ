[General]
SyntaxVersion=2
BeginHotkey=122
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=192
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=34e608e6-a3c7-44c4-a704-fcdf26973e41
Description=SAP 工具箱
Enable=0
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
UEsDBBQAAgAIAMBOn0ezVCshyAQAAFY6AAAJABEAdGVzdDEuYm1wVVQNAAc4+4RWOPuEVjj7hFbtmctPW0cUxk//iy67Aiu1kS6LLrrswkmKQEDSBDerkpC0UkSAEkWiNgShtlKrJCKiECpsh6aLUAVsQLHchNhGobYx4ZGEVq3Aj4S0aqM+1F2XncvQ4Xju3PFELZcuZvRDiDPffOebc68REm/UH3sdttdr5MtFvvw731+Cl7frr+zs45WJ39Q4zNajlMZhNr6Z1Gg0Go1Go9FoNBqNxkGmNE6TjtjRMxEBqAL7dRzgbjoA7ndwZSMdoMfvpiN2W3bmnIZitA9zsh43kQ0zwfFLEW4LV8YaALuNkVTglTRVCcZdjTTtmRhmp7h41qlupqN23EtHwd0K0rV5yUuURvsIq7SQYrqXFD+YiOLw99qrmDM09Eo8gw1QMYBBuky0WrvsZGgANliWR2JIb6EeTC5j2eymms/IMM6NyGfud0M+M0KULZejeOz5TC+ukBj5r1qpJ64LFz1esXviXJWKG1n5y17aOpiJci/5zjAbQT1YIlP5VaTZbMnK8N/afYvMjtleibjlStnYodFb9miyI1QGjWUvSf6K19qRFrGS6250jFBPnNB8srdarV3MkW4XE9mycSU6qnBrxWDBbNmDYyYkkvC+AhanJSQWp8F9EvlXy/X+yWmAasFzRwehqU/RUEWJE5oznzxJ60FSh4O7z2uxj9aNjmt2norB7Dra1QXkZuQYnaNljy83Ktf7p2a4sZtXzl0UGiY6qxVbS5R2Mmi6uPvSDh60xuOuox5M6KzuUMjNyvFPzbKQ5PEVpk690BGyQk0g2bVb5JRvcNbOxM6QjLGQ+5zWhceTuVlwnxJe598Hs0vCs3S7ItDUz1okO6sr6o3OMWtOtpskhp62ilfzkV5L/Uy5PZ82YTtsiGUhUodDzK2w1G+Nh6+jHixEgv3jjDtyDoXBQ+IRPYhVxDcYk/9pVIi0MXHyQUyYPNQMTOOPxOh/x81bd7mEZ6ktbu33EIcxYUKjC40RGQrruDvnqR4MO+Or4cC4jikuxysSXo4DHJaMPdXlYmLf1Th+HOBxsR/DzcBkRlfQWucaFa8eJkVoHsCGxehpZkK2Ah5yNhiIxtmsaIUKhPUUOeg5LTRUD4ZNsDlWkk9EcXlAMNKVr1XAF7cus+NKyKo0m64M4IqdUrjMmVdSmkObPpMiGs8ZXKEHrfUwqdi/P6n3XerB5FbcFcpYvaOCb+hO2dxWrwtl4VUie3P3PTkCtG50Xxcex7aC54i6YAd+UN0uTkAr1oO0Dkc+rNhUMViKuHnelcycTQBTWptTIbw2B1BHfWoBSjPvCWW+oTncsTRUx7Zqu8fttrhTNKqKvzmBGqIcJ1uBGbJ1gCsK61YTtrirKQbDLUzNUB2bFfmkl9Y+4vRPHiYUgaMfM9v58wfUD/4/qT1/Y++ug2f15LM6bvfp46Qibw8n5b+7+mrg6eMv1Q33l77bSfZy/ufJ8azGjwK3u7U+r8gX6/MA9ZKZkw/mVuysuuH+cp9cp+bsHiXHszpBzNc/wbvPvr2vDrz1qfxVX7jw6gsZ7i+1F27uXXI8q2fX6vHWj98taPaCE6MLbOY3jgHe+un7tMZhfv4hq3GYXzZyGod5vrmkcZhf88sah/mtsKJxmN+LaxqH+aP0UOMwf/35XOMwfwNQSwECFwsUAAIACADATp9Hs1QrIcgEAABWOgAACQAJAAAAAAAAACAAgIEAAAAAdGVzdDEuYm1wVVQFAAc4+4RWUEsFBgAAAAABAAEAQAAAAAAFAAAAAA==


[UIPackage]
UEsDBBQAAgAIAIyxQ0l/SZFZJgkAAAiAAAAJABEAVUlQYWNrYWdlVVQNAAfW1/JX1tfyV9bX8lftXVlwFFUUPZ2wJAgIyCb7jsomAYLKIhBE0USQxA1FHZIAkTCJkyCLC4sb7ijuu0ar0D/E5UOrrPLDDy1FodRfrdJSq7SKL8ofifd2zzDtSLRvv8tcx+RSh5cK03P69Xt93znvvW6KEcSXh/p/9+qBYd8jJxaiGMfbS9Ej9DsvDT/6AUUIcLy9vT3z6/auKKj4g9CN2q2c0JPQncBtXkLoRSglnEboQ+hN6Bs0PU4n9CecQRhAGEgYTBhEGEIYRhhKOJMwnDCSMIIwijCGMJowljCeMI4wgTCJMJEwmXA24SzCOYSphCmEaYQZhOmEcwmzCDMJZYTZhLmEOYTz0n3yAirPJ8wjLCDM9/t18G/Hu5rej1Vooj+t1CYXIUllCtsgicHUYzLf5f3LZ3d+W162c+Rhr5h+XjQx+N2VWO63Zdwogedl+Gf8C2+mDP9bBWpQ6XAGvUL83WPw19D1bkY9LkcCm6iUxgDKwOH2jHpct3SZuRe60DmxrCm1yeH2Ax8/0+F4D27herx1HD16VOV71pAQOxbjuLh5J5v/5PnHS+sMDh51EliLxpjn0BdFHusT1i5R+YtC+e8qNKCFEPcM+hF/b2R1b5RjikP8q4g1gTqsoOvQKBx70/nf64FAq0Xl7xbiryH+rTTuO7S/J23/sF+oIPXRSEjFPJOBMfpf91D9s/xLqB1qsVHO7+uZUsH175HT/rWO15+1eYmAvycCDc+xmnpeivpfPf0d8/4TX/+SUP0r6drLr/pf6983/X1R+UtD/MuIP+l2/cX153t1/on+x/pzpgO/53E+G43Ah50s/kl/Wsexk18z/xyrqsdUJ5ItY6rrUw3rOjh+ebJ5c+uSpq1x+VfVuJ1/oesXBf/h5/8RgvvvtHQO4LDQHzxeF6V/1tAfPM8xUFD/PtDVHzzHMlLA3xe6+oPngIYI+E+Hrf7oF7rvFPSHzz9KUP/+UNUffn0GC/gHhPhnGecfwZTFSWO0F8wZ1lNZFeN46/z7Xc4F2Js+Ia/IGxdl/HM9fw39yXO9gwT97wzY6s+B0NWfw9P3dFT+QbDVn5wrMvpzMWWfBqync+BROJkX/zUkVP+VlPVa6M8WPwfWiesfZ/5zaIi/CpvpCrTSNagkJMVjcJz6n4lw/mf9X+bQ/tn553EdfOa/rP9d9XtFJ9fvZY7Ha+n/qYL8x+OFpf7nfK2p/3mdcoKg/iOgq/95rXSagH8kdPU/r+FOFvCPgq3+Hw19/T9dUP8x0NX//H2TBPxjQ/yuoaHfmxDo96djHF8E27DW766hof95j8ZEQf8bB1v9Px66+n9K+p6Kyj8Btvqf28pS/0+Crf6fDFv9fxZy9X/8WRjW/zyftgIda8FTqf8rE2vrG12Pd9hAUOj6/bPXvvz40wMf/tC2//1v2t7s0yvf/Fr6f74g/7Fezaz/W+h/Hq8y+1o19D/vN5wtqP8U6Op/3uO4UMA/Fbr6n7PXXAH/NNjq/+nI6g8t/b9AUP8Z0NX/vHuxXMB/bojfdf8Rj2WsJ4ZSIr0uxvHFsI1C1++uoaH/eZ/1HEH/mwlb/V8GXf0/L12nqPyzYKv/eayy1P9zEM7/Kcp7SRoDm6lMic9haAz+8hD/YtL/rdQG1XQVtudp//Vc5Or/2Q7tn53/X9LBZ07x/nOfv1LQ/1kvWeo/1kua+u8SKpcK6n8BdPXfcv86RuefF85/Gv7NYRGi0P3bh7++/cuhdz8/2Lb/nS/a3sw/v6t+09D/FVReLOh/82Gr/xcg2APFoaX/qwT1Xwhd/b8IrCOi818I3f3Hl4LzaHT+RbDVf4uhq/8uS39nVP4lsNV/FcjqP/ZvvP7C/u2NGPxa60hxo7P7t4oN9bUbHfZPWOj/pbDV/xfBVv8vQ67+n+Nw/3se5/NbwLn85JEP/X+jIP+xVrDc/3FJ6Ppr6P9r/OsYvf7Loar/xfW/NMS/rjGx3iX/FLp+P/zW2x8QfvzkVxt+V/3O+x9eJ7xHOBLjeA39fz2VVwv6/2XQ1/83CPgrETyDxaGl/9cI+Kugq/9X+nkkOv/l0NX/q8HvcYjOvwK2+n8ldPU/r3tcIaj/FbDV/6wTMvq/O2zjZ0f9XujhOv656v8KbPAzwEb6uy7G8Tz/eC2V1YL+X42/5/9VvgvZkBf/URPirybGbbHVHz9LKOe/EmH/kX//dRVy/Ue5Q/7Jrj/UdvCZfPiPZkH/Y61i6T/YL2iuPzRQWS+o/7Wh9k82pTYlHBYA/h/6/8D+r/842GbB76r/P0Kg/1u8ePrfwn+uhu7+I36B0QZB/78O+v6jScDPfql3+mct/5EU8K+Brv9IULlewH8DdP0Hn/M6Af+NsPUfN0HXf3D6XiuofyLE3wO20aX/3cJV/1v4T+6r2fffuPuPm6msE/T/Wtj6jzrY+o962PqPdcj1H3Md+p/n59PdhI7OPR/+Y5eg//FYaek/WCtl5n22pJqSLgsA/xf9f/DYO79Z8Lvq/91eoP/Li+Lpfw3/uZ3KWwX9vwG26183Q9d/3EnlNkH9N0Lff+wU8LNe1PYfOwT8m6DrP1i5bxXwJ6HrP26ncouAvwm2/qM5VP+esI0u/e8Wzvt3FfznHVS2CPr/LbBd/+I7TdN/3EblZkH9W2DrP1ph6z82w9Z/3Ipc/3GeQ/8L1j8ep5/v6eAz+fAfjwr6H49Vls9f8Fituf7xIJX3Ceq/DbrPXzxE5WMC/u3Q1Z/3UvmAgP825Dz/4fASyEL3f5///vFPXx359IAVv6v/Y73E+1kOeYg1ilo8f8F6OTP/oeU/9gr6/x3Q9R93UXm/gP9O6PqPh6ncI+DfAVv/sRO66x+PUHm3oP67YKs/ea7S8vnbu3Bq//+friicKIFtuD6/U+jh+v7TpY7vP7V4/uZu2D5/cw9y/d/5DvnfO8H/ZEfjXR7838uC8Y/9guX6E3s1zfevPo/g3ZFR+fdA1/+9QOUrAv77oev/nqLyOQH/AyH+zv7+Y9dod3z/6ddp/za8KJgXkUap4/lb+L8Hof/+3VcF/f8h6Pq/fVQ+K+B/GLr+70UqnxHwPwJb//codP3fS1Q+Iaj/Xtj6P54rtPR/j0Pvuf3O/vx9oYfF+3f3wfb9u09A970VUn7tcOH/E1BLAQIXCxQAAgAIAIyxQ0l/SZFZJgkAAAiAAAAJAAkAAAAAAAAAAAAAgAAAAABVSVBhY2thZ2VVVAUAB9bX8ldQSwUGAAAAAAEAAQBAAAAAXgkAAAAA


[Script]
A = 0
RT = Cint(form1.RT.text)
CT = Cint(form1.CT.text)
DT = Cint(Form1.DT.text)
Hwndsap = Plugin.Window.Find("SAP_FRONTEND_SESSION", 0)
Hwndwx = Plugin.Window.Find("Chrome_WidgetWin_1", 0)
Hwndwxf = Plugin.Window.FindEx(0, Hwndwx, 0, 0)
Call Plugin.Media.Vol(99)
Call Plugin.Window.Active(Hwndwxf)
Delay 500
Call Plugin.Window.Max(Hwndwxf)
Delay 500
Call Plugin.Window.Active(Hwndsap)
Delay 500
Call Plugin.Window.Max(Hwndsap)
Delay 500
Sub checkwx()
    KeyDown 18, 1
    KeyPress "Tab", 1
    KeyUp 18, 1
    Delay 1000
    MoveTo 311, 289
    LeftClick 1
    Delay 1000
    CSC=GetPixelColor(528,551)
    TracePrint CSC
    If CSC = "24FFFF" Then
        KeyDown 18, 1
        KeyPress "Tab", 1
        KeyUp 18, 1
        Delay 1000
        MoveTo 311, 289
        LeftClick 1
        Delay 1000 
        Call copyscreen()
         KeyDown 18, 1
        KeyPress "Tab", 1
        KeyUp 18, 1
        Delay 1000
    End If
    CTC=GetPixelColor(526,553)
    TracePrint CTC
    If CTC = "0045ED" Then 
        CWX = 286
        CWY = 295
        KeyDown 18, 1
        KeyPress "Tab", 1
        KeyUp 18, 1
        Delay 1000
        MoveTo CWX, CWY
        LeftClick 1
        Delay 1000
        KeyDown 17, 1
        KeyPress 116, 1
        KeyUp 17, 1
        Delay 3000
        MoveTo 667, 302
        LeftClick 1
        Delay 1000
        KeyDown 17, 1
        KeyPress 65, 1
        KeyUp 17, 1
        Delay 1000
        KeyDown 17, 1
        KeyPress 67, 1
        KeyUp 17, 1
        Delay 1000
        KeyPress "F12", 1
        Call movetowx()
        KeyDown 18, 1
        KeyPress "Tab", 1
        KeyUp 18, 1
        Delay 1000
    End If
    KeyDown 18, 1
    KeyPress "Tab", 1
    KeyUp 18, 1
    Delay 1000
End Sub
Sub movetowx()
    KeyDown 18, 1
    KeyPress "Tab", 1
    KeyUp 18, 1
    Delay 1000
    MoveTo 311, 289
    LeftClick 1
    Delay 1000
    MoveTo 763, 673
    LeftClick 1
    Delay 1000
    KeyDown 17, 1
    KeyPress 86, 1
    KeyUp 17, 1
    Delay 1000
    KeyPress "Enter", 1
    Delay 1000
    KeyDown 18, 1
    KeyPress "Tab", 1
    KeyUp 18, 1
    Delay 1000
End Sub
While A < CT 
    A = A + 1
    Call Plugin.Media.Beep(523, 200)
    Call checkwx()
    FindColorEx 800, 400, 850, 450, "FFFFFF", 0, 1, ErrX, ErrY
    If ErrX > 0 Then 
        Call Plugin.Sys.SetCLB(Time & "网络断线")
        MoveTo 844, 491
        LeftClick 1
        Delay 1000
        MoveTo 311, 289
        LeftClick 1
        Delay 1000
        MoveTo 763, 673
        LeftClick 1
        Delay 1000
        KeyDown 17, 1
        KeyPress 86, 1
        KeyUp 17, 1
        Delay 1000
        KeyPress "Enter", 1
        Delay 1000
        ExitScript 
    End If
    Delay 2000
    KeyPress "F5", 1
    Delay 6000 *((DT+1)/2)
    FindColorEx 100,265,500,500,"666666",0,1,intX,intY
    If intX > 0 And intY > 0 Then
        Call Plugin.Media.Play("C:\Windows\Media\tada.wav")
        MoveTo intX, intY
        LeftClick 1
        Delay 1000
        KeyDown 17, 1
        KeyPress 116, 1
        KeyUp 17, 1
        Delay 3000
        MoveTo 667, 302
        LeftClick 1
        Delay 1000
        KeyDown 17, 1
        KeyPress 65, 1
        KeyUp 17, 1
        Delay 1000
        KeyDown 17, 1
        KeyPress 67, 1
        KeyUp 17, 1
        Delay 1000
        KeyPress "F12", 1
        Call movetowx()
        Delay 30000
        If form1.flag.Value = 1 Then 
            MoveTo intX, intY
            LeftClick 1
            Delay 1000
            KeyPress "F9", 1
            Delay 7000 *((DT+1)/2)
            MoveTo 846, 583
            LeftClick 1
            Delay 1000
            MoveTo 721, 501
            LeftClick 1
            Delay 1000
            MoveTo 885, 583
            LeftClick 1
            Delay 1000
        End If
    Else
        Call Plugin.Media.Beep(523, 200)
    End If
    Delay RT*60000
Wend
Sub Copyscreen()
    KeyPress "Print Screen", 1
    Delay 1000
    KeyDown 18, 1
    KeyPress "Tab", 1
    KeyUp 18, 1
    Delay 1000
    MoveTo 311, 289
    LeftClick 1
    Delay 1000
    MoveTo 763, 673
    LeftClick 1
    Delay 1000
    KeyDown 17, 1
    KeyPress 86, 1
    KeyUp 17, 1
    Delay 30000
    MoveTo 749, 621
    LeftClick 1
    Delay 15000
    KeyDown 18, 1
    KeyPress "Tab", 1
    KeyUp 18, 1
    Delay 1000
End Sub
If form1.normal.value = 1 or form1.wrong.value = 1 Then 
    Call copyscreen()
    FindPic 0, 0, 300, 300, "Attachment:\test1.bmp", 0.8, intX, intY
    If intX > 0 And form1.normal.value = 1 Then 
        Call Plugin.Sys.SetCLB(Time & "系统正常")
        Call movetowx()
    End If
    If intX < 0 And form1.wrong.value = 1 Then 
        Call Plugin.Sys.SetCLB(Time & "系统故障")
        Call movetowx()
    End If
    If intX < 0 Then 
        ExitScript
    End If
End If